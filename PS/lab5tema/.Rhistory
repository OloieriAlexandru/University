x = rexp(1);
sum = sum + (1/(2*x*x+1))/exp(-x);
}
sum = sum/n;
return (sum);
}
integrala2 = function()
{
pi = 3.141592653589793;
ans = pi/(2*sqrt(2));
n = 10000;
k = 30;
estimate = vector();
for (i in 1:k)
estimate[i] = computeSecondI(n);
sum = mean(estimate);
cat("Valoarea integralei: ",ans,", rezultatul aproximat: ",sum,"\n");
cat("Eroarea absoluta: ", abs(ans-sum),"\n");
}
integrala2();
computeSecondI = function(n)
{
sum = 0;
for (i in 1:n)
{
x = rexp(1);
sum = sum + (1/(2*x*x+1))/exp(-x);
}
sum = sum/n;
return (sum);
}
integrala2 = function()
{
pi = 3.141592653589793;
ans = pi/(2*sqrt(2));
n = 50000;
k = 30;
estimate = vector();
for (i in 1:k)
estimate[i] = computeSecondI(n);
sum = mean(estimate);
cat("Valoarea integralei: ",ans,", rezultatul aproximat: ",sum,"\n");
cat("Eroarea absoluta: ", abs(ans-sum),"\n");
}
integrala2();
computeSecondI = function(n)
{
sum = 0;
for (i in 1:n)
{
x = rexp(1);
sum = sum + (1/(2*x*x+1))/rexp(-x);
}
sum = sum/n;
return (sum);
}
integrala2 = function()
{
pi = 3.141592653589793;
ans = pi/(2*sqrt(2));
n = 5000;
k = 30;
estimate = vector();
for (i in 1:k)
estimate[i] = computeSecondI(n);
sum = mean(estimate);
cat("Valoarea integralei: ",ans,", rezultatul aproximat: ",sum,"\n");
cat("Eroarea absoluta: ", abs(ans-sum),"\n");
}
integrala2();
computeSecondI = function(n)
{
sum = 0;
for (i in 1:n)
{
x = rexp(1);
sum = sum + (1/(2*x*x+1))/exp(-x);
}
sum = sum/n;
return (sum);
}
integrala2 = function()
{
pi = 3.141592653589793;
ans = pi/(2*sqrt(2));
n = 5000;
k = 30;
estimate = vector();
for (i in 1:k)
estimate[i] = computeSecondI(n);
sum = mean(estimate);
cat("Valoarea integralei: ",ans,", rezultatul aproximat: ",sum,"\n");
cat("Eroarea absoluta: ", abs(ans-sum),"\n");
}
integrala2();
computeSecondI = function(n)
{
sum = 0;
for (i in 1:n)
{
x = rexp(1);
sum = sum + (1/(2*x*x+1))/exp(-x);
}
sum = sum/n;
return (sum);
}
integrala2 = function()
{
pi = 3.141592653589793;
ans = pi/(2*sqrt(2));
n = 10000;
k = 30;
estimate = vector();
for (i in 1:k)
estimate[i] = computeSecondI(n);
sum = mean(estimate);
cat("Valoarea integralei: ",ans,", rezultatul aproximat: ",sum,"\n");
cat("Eroarea absoluta: ", abs(ans-sum),"\n");
}
integrala2();
computeSecondI = function(n)
{
sum = 0;
for (i in 1:n)
{
x = rexp(1);
sum = sum + (1/(2*x*x+1))/exp(-x);
}
sum = sum/n;
return (sum);
}
integrala2 = function()
{
pi = 3.141592653589793;
ans = pi/(2*sqrt(2));
n = 10000;
k = 30;
estimate = vector();
for (i in 1:k)
estimate[i] = computeSecondI(n);
sum = mean(estimate);
cat("Valoarea integralei: ",ans,", rezultatul aproximat: ",sum,"\n");
cat("Eroarea absoluta: ", abs(ans-sum),"\n");
}
integrala2();
computeSecondI = function(n)
{
sum = 0;
for (i in 1:n)
{
x = rexp(1);
sum = sum + (1/(2*x*x+1))/exp(-x);
}
sum = sum/n;
return (sum);
}
integrala2 = function()
{
pi = 3.141592653589793;
ans = pi/(2*sqrt(2));
n = 10000;
k = 30;
estimate = vector();
for (i in 1:k)
estimate[i] = computeSecondI(n);
sum = mean(estimate);
cat("Valoarea integralei: ",ans,", rezultatul aproximat: ",sum,"\n");
cat("Eroarea absoluta: ", abs(ans-sum),"\n");
}
integrala2();
computeSecondI = function(n)
{
sum = 0;
for (i in 1:n)
{
x = rexp(1);
sum = sum + (1/(2*x*x+1))/exp(-x);
}
sum = sum/n;
return (sum);
}
integrala2 = function()
{
pi = 3.141592653589793;
ans = pi/(2*sqrt(2));
n = 10000;
k = 30;
estimate = vector();
for (i in 1:k)
estimate[i] = computeSecondI(n);
sum = mean(estimate);
cat("Valoarea integralei: ",ans,", rezultatul aproximat: ",sum,"\n");
cat("Eroarea absoluta: ", abs(ans-sum),"\n");
}
integrala2();
# D2
zConfidenceInterval = function(n,xn,nivelIncredere,disp)
{
alpha = 1 - nivelIncredere;
sampleMean = xn;
sigma = sqrt(disp);
criticalZ = qnorm(1-alpha/2,mean=0,sd=1);
a = sampleMean - criticalZ*sigma/sqrt(n);
b = sampleMean + criticalZ*sigma/sqrt(n);
interval = c(a,b);
return (interval);
}
zConfidenceInterval(196,35,0.99,16);
# D1
zConfidenceInterval(8,140,0.95,10^2)
zconfidence_interval <- function(n,sample_mean,alfa,sigma){
critical_z = qnorm(1 - alfa/2, 0, 1)
a = sample_mean - critical_z*sigma/sqrt(n)
b = sample_mean + critical_z*sigma/sqrt(n)
interval = c(a, b)
return(interval)
}
x=zconfidence_interval(8,140,0.05,10)
cat(sprintf("Intervalul cautat este (%f,%f).\n",x[1],x[2]))
d1 = zConfidenceInterval(8,140,0.95,10^2);
cat("Intervalul: [",d1[1],",",d1[2],"]\n");
zConfidenceInterval = function(n,xn,nivelIncredere,disp)
{
alpha = 1 - nivelIncredere;
sampleMean = xn;
sigma = sqrt(disp);
criticalZ = qnorm(1-alpha/2,mean=0,sd=1);
a = sampleMean - criticalZ*sigma/sqrt(n);
b = sampleMean + criticalZ*sigma/sqrt(n);
interval = c(a,b);
return (interval);
}
d2 = zConfidenceInterval(196,35,0.99,16);
cat("Intervalul: [",d2[1],",",d2[2],"]\n");
#D4
test_proportion <- function(alfa,n,succese,p0,tiptest){
cat(sprintf("Ipoteza initiala H0 este %f.\n",p0));
p_prim = succese/n;
z_score = (p_prim - p0)/sqrt(p0*(1 - p0)/n);
cat(sprintf("Scorul testului este %f.\n",z_score));
if(tiptest == 'stanga'){
critical_z = qnorm(alfa);
cat(sprintf("Valoarea critica este %f.\n",critical_z));
if(z_score>critical_z){
cat(print("Se accepta ipoteza nula!\n"));
}
else{
cat(print("Se respinge ipoteza nula!\n"));
}
}
else
{
if(tiptest == 'dreapta'){
critical_z = qnorm(1-alfa);
cat(sprintf("Valoarea critica este %f.\n",critical_z));
if(z_score<critical_z){
cat(print("Se accepta ipoteza nula!\n"));
}
else{
cat(print("Se respinge ipoteza nula!\n"));
}
}
else{
critical_z = qnorm(1-alfa/2);
cat(sprintf("Valoarea critica este %f.\n",critical_z));
if(abs(z_score)<abs(critical_z)){
cat(print("Se accepta ipoteza nula!\n"));
}
else{
cat(print("Se respinge ipoteza nula!\n"));
}
}
}
}
#H0 - proportia nu este mai mica( p0 = 0.509 )
#Ha - proportia este mai mica( p < p0 )
#p < p0 - ipoteza asimetrica la stanga
test_proportion(0.01,100,48,0.509,'stanga')
test_proportion(0.05,100,48,0.509,'stanga')
testProportion(0.01,100,48,0.509,1);
# D3
testProportion = function(alpha, n, success, p0, type)
#type = 1 -> asimetric stanga
#type = 2 -> asimetric dreapta
#type = 3 -> ipoteza simetrica
{
pPrim = success / n;
zScor = (pPrim - p0)/(sqrt(p0*(1-p0)/n));
ok = FALSE;
if (type == 1)
{
zStar = qnorm(alpha,0,1);
if (zScor > zStar)
{
print("Se accepta");
ok = TRUE;
}
}
else
if (type == 2)
{
zStar = qnorm(1-alpha,0,1);
print(zScor);
print(zStar);
if (zScor < zStar)
{
print("Se accepta");
ok = TRUE;
}
}
else
{
zStar = qnorm(1-alpha/2,0,1);
if (abs(zScor) < abs(zStar))
{
print("Se accepta");
ok = TRUE;
}
}
if (ok == FALSE)
{
print("Se respinge");
}
}
testProportion(0.01,100,32,0.3,2)
testProportion(0.05,100,32,0.3,2)
#D4
testProportion(0.01,100,48,0.509,1);
testProportion(0.05,100,48,0.509,1);
# D3
testProportion = function(alpha, n, success, p0, type)
#type = 1 -> asimetric stanga
#type = 2 -> asimetric dreapta
#type = 3 -> ipoteza simetrica
{
pPrim = success / n;
zScor = (pPrim - p0)/(sqrt(p0*(1-p0)/n));
ok = FALSE;
if (type == 1)
{
zStar = qnorm(alpha,0,1);
if (zScor > zStar)
{
print("Se accepta ipoteza nula");
ok = TRUE;
}
}
else
if (type == 2)
{
zStar = qnorm(1-alpha,0,1);
print(zScor);
print(zStar);
if (zScor < zStar)
{
print("Se accepta ipoteza nula");
ok = TRUE;
}
}
else
{
zStar = qnorm(1-alpha/2,0,1);
if (abs(zScor) < abs(zStar))
{
print("Se accepta ipoteza nula");
ok = TRUE;
}
}
if (ok == FALSE)
{
print("Se respinge ipoteza nula");
}
}
testProportion(0.01,100,32,0.3,2)
testProportion(0.05,100,32,0.3,2)
#D4
testProportion(0.01,100,48,0.509,1)
testProportion(0.05,100,48,0.509,1)
setwd("D:/R/lab5tema")
testProportion = function(alpha, n, success, p0, type)
#type = 1 -> asimetric stanga
#type = 2 -> asimetric dreapta
#type = 3 -> ipoteza simetrica
{
pPrim = success / n;
zScor = (pPrim - p0)/(sqrt(p0*(1-p0)/n));
ok = FALSE;
if (type == 1)
{
zStar = qnorm(alpha,0,1);
if (zScor > zStar)
ok = TRUE;
}
else
if (type == 2)
{
zStar = qnorm(1-alpha,0,1);
if (zScor < zStar)
ok = TRUE;
}
else
{
zStar = qnorm(1-alpha/2,0,1);
if (abs(zScor) < abs(zStar))
ok = TRUE;
}
if (ok == TRUE)
printf("Se accepta ipoteza nula");
if (ok == FALSE)
print("Se respinge ipoteza nula");
}
testProportion(0.01,100,32,0.3,2)
testProportion(0.05,100,32,0.3,2)
# D3
testProportion = function(alpha, n, success, p0, type)
#type = 1 -> asimetric stanga
#type = 2 -> asimetric dreapta
#type = 3 -> ipoteza simetrica
{
pPrim = success / n;
zScor = (pPrim - p0)/(sqrt(p0*(1-p0)/n));
ok = FALSE;
if (type == 1)
{
zStar = qnorm(alpha,0,1);
if (zScor > zStar)
ok = TRUE;
}
else
if (type == 2)
{
zStar = qnorm(1-alpha,0,1);
if (zScor < zStar)
ok = TRUE;
}
else
{
zStar = qnorm(1-alpha/2,0,1);
if (abs(zScor) < abs(zStar))
ok = TRUE;
}
if (ok == TRUE)
print("Se accepta ipoteza nula");
if (ok == FALSE)
print("Se respinge ipoteza nula");
}
testProportion(0.01,100,32,0.3,2)
testProportion(0.05,100,32,0.3,2)
# Tema 5 PS Oloieri Alexandru
# D2
zConfidenceInterval = function(n,xn,nivelIncredere,disp)
{
alpha = 1 - nivelIncredere;
sampleMean = xn;
sigma = sqrt(disp);
criticalZ = qnorm(1-alpha/2,mean=0,sd=1);
a = sampleMean - criticalZ*sigma/sqrt(n);
b = sampleMean + criticalZ*sigma/sqrt(n);
interval = c(a,b);
return (interval);
}
d2 = zConfidenceInterval(196,35,0.99,16);
cat("Intervalul: [",d2[1],",",d2[2],"]\n");
# D1
d1 = zConfidenceInterval(8,140,0.95,10^2);
cat("Intervalul: [",d1[1],",",d1[2],"]\n");
# D3
testProportion = function(alpha, n, success, p0, type)
#type = 1 -> asimetric stanga
#type = 2 -> asimetric dreapta
#type = 3 -> ipoteza simetrica
{
pPrim = success / n;
zScor = (pPrim - p0)/(sqrt(p0*(1-p0)/n));
ok = FALSE;
if (type == 1)
{
zStar = qnorm(alpha,0,1);
if (zScor >= zStar)
ok = TRUE;
}
if (type == 2)
{
zStar = qnorm(1-alpha,0,1);
if (zScor <= zStar)
ok = TRUE;
}
if (type == 3)
{
zStar = qnorm(1-alpha/2,0,1);
if (abs(zScor) <= abs(zStar))
ok = TRUE;
}
if (ok == TRUE)
print("Se accepta ipoteza nula, se respinge ipoteza alternativa");
if (ok == FALSE)
print("Se accepta ipoteza alternativa, se respinge ipoteza nula");
}
testProportion(0.01,100,32,0.3,2)
testProportion(0.05,100,32,0.3,2)
#D4
testProportion(0.01,100,48,0.509,1)
testProportion(0.05,100,48,0.509,1)
zconfidence_interval <- function(n,sample_mean,alfa,sigma){
critical_z = qnorm(1 - alfa/2, 0, 1)
a = sample_mean - critical_z*sigma/sqrt(n)
b = sample_mean + critical_z*sigma/sqrt(n)
interval = c(a, b)
return(interval)
}
x=zconfidence_interval(8,140,0.05,10)
cat(sprintf("Intervalul cautat este (%f,%f).\n",x[1],x[2]))
